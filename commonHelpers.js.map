{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nlet page = 1;\n\nconst inputForm = document.getElementById('search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadButton = document.querySelector('.js-load');\n\ninputForm.addEventListener('submit', handlerSubmit);\nloadButton.addEventListener('click', handlerLoad);\n\nasync function handlerLoad() {\n  page += 1;\n  try {\n    const data = await fetchImages(inputForm.elements.searchQuery.value, page);\n    gallery.innerHTML += createMarkup(data);\n\n    if (page >= data.totalPages) {\n      loadButton.classList.replace('load-more', 'load-more-hidden');\n    }\n    lightbox.refresh();\n    smoothScroll();\n  } catch (error) {\n    console.error('error', error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Oops! Something went wrong! Try reloading the page!',\n      position: 'topRight',\n    });\n  }\n}\n\nasync function handlerSubmit(evt) {\n  evt.preventDefault();\n\n  page = 1;\n\n  const searchInput = evt.currentTarget.elements.searchQuery.value;\n\n  try {\n    const data = await fetchImages(searchInput, page);\n\n    if (data.data.length === 0) {\n      gallery.innerHTML = '';\n      loadButton.classList.replace('load-more', 'load-more-hidden');\n\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n      });\n    } else {\n      gallery.innerHTML = createMarkup(data);\n\n      if (page < data.totalPages) {\n        loadButton.classList.replace('load-more-hidden', 'load-more');\n      }\n    }\n    lightbox.refresh();\n    smoothScroll();\n  } catch (error) {\n    console.error('error', error);\n  }\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nasync function fetchImages(searchInput, page) {\n  const API_KEY = '40948305-cf809bb8656872e1f12174930';\n  const BASE_URL = 'https://pixabay.com/api/';\n  const perPage = 40;\n\n  const url = `${BASE_URL}?key=${API_KEY}&q=${searchInput}&page=${page}&per_page=${perPage}&image_type=photo&orientation=horizontal&safesearch=true`;\n\n  try {\n    const response = await axios.get(url);\n    if (response.data && response.data.hits) {\n      return {\n        data: response.data.hits,\n        totalPages: Math.ceil(response.data.totalHits / perPage),\n      };\n    } else {\n      console.error('Invalid response format:', response);\n      throw new Error('Invalid response format');\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Oops! Something went wrong! Try reloading the page!',\n      position: 'topRight',\n    });\n    throw error;\n  }\n}\n\nfunction createMarkup(data) {\n  const { data: images } = data;\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<div class=\"photo-card\">\n          <a class=\"photo-card__link\" href=\"${largeImageURL}\">\n            <img class=\"photo-card__image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n              <p class=\"info-item\"><b>Likes</b> <span class=\"info-item__wrapper\">${likes}</span></p>\n              <p class=\"info-item\"><b>Views</b> <span class=\"info-item__wrapper\">${views}</span></p>\n              <p class=\"info-item\"><b>Comments</b> <span class=\"info-item__wrapper\">${comments}</span></p>\n              <p class=\"info-item\"><b>Downloads</b> <span class=\"info-item__wrapper\">${downloads}</span></p>\n            </div>\n          </a>\n        </div>`\n    )\n    .join('');\n}\n\nconst lightbox = new SimpleLightbox('.gallery a');\n"],"names":["page","inputForm","gallery","loadButton","handlerSubmit","handlerLoad","data","fetchImages","createMarkup","lightbox","smoothScroll","error","iziToast","evt","searchInput","cardHeight","url","response","axios","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox"],"mappings":"owBAIA,IAAIA,EAAO,EAEX,MAAMC,EAAY,SAAS,eAAe,aAAa,EACjDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAa,SAAS,cAAc,UAAU,EAEpDF,EAAU,iBAAiB,SAAUG,CAAa,EAClDD,EAAW,iBAAiB,QAASE,CAAW,EAEhD,eAAeA,GAAc,CAC3BL,GAAQ,EACR,GAAI,CACF,MAAMM,EAAO,MAAMC,EAAYN,EAAU,SAAS,YAAY,MAAOD,CAAI,EACzEE,EAAQ,WAAaM,EAAaF,CAAI,EAElCN,GAAQM,EAAK,YACfH,EAAW,UAAU,QAAQ,YAAa,kBAAkB,EAE9DM,EAAS,QAAO,EAChBC,GACD,OAAQC,EAAP,CACA,QAAQ,MAAM,QAASA,CAAK,EAC5BC,EAAS,MAAM,CACb,MAAO,QACP,QAAS,sDACT,SAAU,UAChB,CAAK,CACF,CACH,CAEA,eAAeR,EAAcS,EAAK,CAChCA,EAAI,eAAc,EAElBb,EAAO,EAEP,MAAMc,EAAcD,EAAI,cAAc,SAAS,YAAY,MAE3D,GAAI,CACF,MAAMP,EAAO,MAAMC,EAAYO,EAAad,CAAI,EAE5CM,EAAK,KAAK,SAAW,GACvBJ,EAAQ,UAAY,GACpBC,EAAW,UAAU,QAAQ,YAAa,kBAAkB,EAE5DS,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,UAClB,CAAO,IAEDV,EAAQ,UAAYM,EAAaF,CAAI,EAEjCN,EAAOM,EAAK,YACdH,EAAW,UAAU,QAAQ,mBAAoB,WAAW,GAGhEM,EAAS,QAAO,EAChBC,GACD,OAAQC,EAAP,CACA,QAAQ,MAAM,QAASA,CAAK,CAC7B,CACH,CAEA,SAASD,GAAe,CACtB,KAAM,CAAE,OAAQK,CAAU,EAAK,SAC5B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH,CAEA,eAAeR,EAAYO,EAAad,EAAM,CAK5C,MAAMgB,EAAM,qEAAgCF,UAAoBd,cAAiB,6DAEjF,GAAI,CACF,MAAMiB,EAAW,MAAMC,EAAM,IAAIF,CAAG,EACpC,GAAIC,EAAS,MAAQA,EAAS,KAAK,KACjC,MAAO,CACL,KAAMA,EAAS,KAAK,KACpB,WAAY,KAAK,KAAKA,EAAS,KAAK,UAAY,EAAO,CAC/D,EAEM,cAAQ,MAAM,2BAA4BA,CAAQ,EAC5C,IAAI,MAAM,yBAAyB,CAE5C,OAAQN,EAAP,CACA,MAAAC,EAAS,MAAM,CACb,MAAO,QACP,QAAS,sDACT,SAAU,UAChB,CAAK,EACKD,CACP,CACH,CAEA,SAASH,EAAaF,EAAM,CAC1B,KAAM,CAAE,KAAMa,CAAQ,EAAGb,EACzB,OAAOa,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,IACC;AAAA,8CACsCL;AAAA,kDACID,WAAsBE;AAAA;AAAA,mFAEWC;AAAA,mFACAC;AAAA,sFACGC;AAAA,uFACCC;AAAA;AAAA;AAAA,eAIlF,EACA,KAAK,EAAE,CACZ,CAEA,MAAMjB,EAAW,IAAIkB,EAAe,YAAY"}